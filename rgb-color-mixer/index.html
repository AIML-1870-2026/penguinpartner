<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RGB Color Studio</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #0a0a0f; color: rgba(255,255,255,0.9); font-family: 'Inter', sans-serif; overflow-x: hidden; }
    #root { min-height: 100vh; }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px 8px var(--glow-color, rgba(255,255,255,0.3)); }
      50% { box-shadow: 0 0 40px 16px var(--glow-color, rgba(255,255,255,0.3)); }
    }
    @keyframes fadeSlideUp {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes toastIn  { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
    @keyframes toastOut { from { opacity:1; } to { opacity:0; } }
    @keyframes diceRotate { from { transform:rotate(0deg); } to { transform:rotate(360deg); } }
    @keyframes fixFlash {
      0%   { outline: 3px solid #22c55e; }
      100% { outline: 3px solid transparent; }
    }

    /* Range inputs */
    input[type=range] {
      -webkit-appearance: none; appearance: none;
      height: 7px; border-radius: 4px; outline: none; cursor: pointer;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 22px; height: 22px; border-radius: 50%;
      cursor: pointer; border: 2px solid rgba(255,255,255,0.35);
    }
    input[type=range].r-slider::-webkit-slider-thumb { background:#ff4444; box-shadow:0 0 6px 2px rgba(255,68,68,0.55); }
    input[type=range].g-slider::-webkit-slider-thumb { background:#44dd44; box-shadow:0 0 6px 2px rgba(68,221,68,0.55); }
    input[type=range].b-slider::-webkit-slider-thumb { background:#4488ff; box-shadow:0 0 6px 2px rgba(68,136,255,0.55); }

    /* Swatch hover */
    .swatch { transition: transform 0.2s ease, box-shadow 0.2s ease; cursor: pointer; }
    .swatch:hover { transform: scale(1.08); }

    /* Pill buttons */
    .pill { border: none; font-family: 'Inter', sans-serif; cursor: pointer; transition: all 0.2s ease; }
    .pill:focus-visible { outline: 2px solid rgba(255,255,255,0.5); outline-offset: 2px; }

    /* Beam hover brightening */
    .beam { transition: filter 0.2s ease, opacity 0.25s ease; }
    .beam:hover { filter: brightness(1.3) blur(6px) !important; }

    /* Inspire btn dice */
    .inspire-btn:hover .dice { animation: diceRotate 0.6s ease; }

    /* Toast */
    .toast { pointer-events: none; }

    /* Number inputs */
    input[type=number] { -moz-appearance: textfield; }
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 3px; }

    /* Toolkit accordion */
    .toolkit-body { transition: max-height 0.4s ease, opacity 0.3s ease; overflow: hidden; }

    @media (max-width: 767px) {
      .explorer-section { height: auto !important; min-height: 300px !important; }
      .beam-area { min-height: 220px !important; }
      .center-circle { width: 120px !important; height: 120px !important; }
      .slider-row { padding: 6px 4% 12px !important; }
      .palette-section { padding: 16px 4% !important; }
      .swatch-rect { width: 60px !important; height: 80px !important; }
    }
  </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useCallback, useRef, useMemo } = React;

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   COLOR UTILITIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function hexToRgb(hex) {
  const h = hex.replace('#','');
  return {
    r: parseInt(h.slice(0,2),16),
    g: parseInt(h.slice(2,4),16),
    b: parseInt(h.slice(4,6),16)
  };
}
function clamp(v, lo=0, hi=255) { return Math.max(lo, Math.min(hi, v)); }
function rgbToHex(r,g,b) {
  return '#' + [r,g,b].map(v=>clamp(Math.round(v)).toString(16).padStart(2,'0')).join('');
}
function rgbToHsl(r,g,b) {
  r/=255; g/=255; b/=255;
  const max=Math.max(r,g,b), min=Math.min(r,g,b);
  let h,s, l=(max+min)/2;
  if(max===min){ h=s=0; }
  else {
    const d=max-min;
    s = l>0.5 ? d/(2-max-min) : d/(max+min);
    switch(max){
      case r: h=((g-b)/d+(g<b?6:0))/6; break;
      case g: h=((b-r)/d+2)/6; break;
      case b: h=((r-g)/d+4)/6; break;
    }
  }
  return {h:h*360, s:s*100, l:l*100};
}
function hslToRgb(h,s,l) {
  h/=360; s/=100; l/=100;
  if(s===0) { const v=Math.round(l*255); return {r:v,g:v,b:v}; }
  const q = l<0.5 ? l*(1+s) : l+s-l*s;
  const p = 2*l-q;
  const hue2rgb = (p,q,t) => {
    if(t<0)t+=1; if(t>1)t-=1;
    if(t<1/6) return p+(q-p)*6*t;
    if(t<1/2) return q;
    if(t<2/3) return p+(q-p)*(2/3-t)*6;
    return p;
  };
  return {
    r: Math.round(hue2rgb(p,q,h+1/3)*255),
    g: Math.round(hue2rgb(p,q,h)*255),
    b: Math.round(hue2rgb(p,q,h-1/3)*255)
  };
}
function toLinear(v) {
  v/=255;
  return v<=0.03928 ? v/12.92 : Math.pow((v+0.055)/1.055, 2.4);
}
function toSRGB(v) {
  return v<=0.0031308 ? 12.92*v : 1.055*Math.pow(v,1/2.4)-0.055;
}
function relativeLuminance(r,g,b) {
  return 0.2126*toLinear(r) + 0.7152*toLinear(g) + 0.0722*toLinear(b);
}
function contrastRatio(rgb1, rgb2) {
  const l1 = relativeLuminance(rgb1.r,rgb1.g,rgb1.b);
  const l2 = relativeLuminance(rgb2.r,rgb2.g,rgb2.b);
  const lighter=Math.max(l1,l2), darker=Math.min(l1,l2);
  return (lighter+0.05)/(darker+0.05);
}
function getTextColor(hex) {
  const {r,g,b} = hexToRgb(hex);
  return relativeLuminance(r,g,b) > 0.179 ? '#000000' : '#ffffff';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   COLOR BLINDNESS MATRICES (Machado 2009)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const CB_MATRICES = {
  protanopia: [
    [ 0.152286,  1.052583, -0.204868],
    [ 0.114503,  0.786281,  0.099216],
    [-0.003882, -0.048116,  1.051998]
  ],
  deuteranopia: [
    [ 0.367322,  0.860646, -0.227968],
    [ 0.280085,  0.672501,  0.047413],
    [-0.011820,  0.042940,  0.968881]
  ],
  tritanopia: [
    [ 1.255528, -0.076749, -0.178779],
    [-0.078411,  0.930809,  0.147602],
    [ 0.004733,  0.691367,  0.303900]
  ],
  achromatopsia: [
    [0.2126, 0.7152, 0.0722],
    [0.2126, 0.7152, 0.0722],
    [0.2126, 0.7152, 0.0722]
  ]
};

function simulateCB(hex, type) {
  const {r,g,b} = hexToRgb(hex);
  const lr=toLinear(r), lg=toLinear(g), lb=toLinear(b);
  const m = CB_MATRICES[type];
  const nr = m[0][0]*lr + m[0][1]*lg + m[0][2]*lb;
  const ng = m[1][0]*lr + m[1][1]*lg + m[1][2]*lb;
  const nb = m[2][0]*lr + m[2][1]*lg + m[2][2]*lb;
  return rgbToHex(
    Math.round(clamp(toSRGB(nr),0,1)*255),
    Math.round(clamp(toSRGB(ng),0,1)*255),
    Math.round(clamp(toSRGB(nb),0,1)*255)
  );
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   HARMONY ALGORITHMS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function colorAt(h, s, l) {
  const {r,g,b} = hslToRgb((h%360+360)%360, clamp(s,5,95), clamp(l,10,90));
  return rgbToHex(r,g,b);
}
function generatePalette(baseHex, mode) {
  const {r,g,b} = hexToRgb(baseHex);
  const {h,s,l} = rgbToHsl(r,g,b);
  switch(mode) {
    case 'analogous':
      return [
        colorAt(h,   s,    l),
        colorAt(h+15,s,    l+3),
        colorAt(h+30,s-5,  l+6),
        colorAt(h-15,s,    l-3),
        colorAt(h-30,s-5,  l-6)
      ];
    case 'triadic':
      return [
        colorAt(h,      s,    l),
        colorAt(h+120,  s-5,  l+7),
        colorAt(h+240,  s+5,  l-7)
      ];
    case 'split-complementary':
      return [
        colorAt(h,      s,    l),
        colorAt(h+150,  s-5,  l+5),
        colorAt(h+210,  s+5,  l-5),
        colorAt(h+150,  s-12, l+12),
        colorAt(h+210,  s-12, l+12)
      ];
    case 'tetradic':
      return [
        colorAt(h,      s,    l),
        colorAt(h+90,   s-10, l+5),
        colorAt(h+180,  s,    l),
        colorAt(h+270,  s-10, l-5)
      ];
    case 'aesthetic':
      // Golden-angle inspired with saturation clusters
      return [
        colorAt(h,           s,    l),
        colorAt(h+137.5,     s-15, clamp(l+15,20,85)),
        colorAt(h+275,       s+5,  clamp(l-10,10,80)),
        colorAt(h+52.5,      s-20, clamp(l+20,20,90)),
        colorAt(h+192.5,     s+10, clamp(l-20,10,75))
      ];
    default: return [baseHex];
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   THRESHOLD HELPERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const THRESHOLD_MAP = {
  'aa-normal': 4.5,
  'aa-large':  3.0,
  'aaa-normal':7.1,
  'aaa-large': 4.5
};
function thresholdLabel(t) {
  return t.replace('-',' ').toUpperCase();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   AUTO-FIX: binary search lightness
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function autoFix(palette, threshold) {
  let fixed = [...palette];
  for(let i=0; i<fixed.length; i++){
    for(let j=i+1; j<fixed.length; j++){
      const rgb1 = hexToRgb(fixed[i]);
      const rgb2 = hexToRgb(fixed[j]);
      if(contrastRatio(rgb1,rgb2) < threshold){
        const {h,s,l} = rgbToHsl(rgb2.r,rgb2.g,rgb2.b);
        // Binary search toward white
        let lo=l, hi=100, bestHex=fixed[j];
        for(let k=0;k<20;k++){
          const mid=(lo+hi)/2;
          const c = hslToRgb(h, clamp(s,5,95), mid);
          if(contrastRatio(rgb1,c) >= threshold){ bestHex=rgbToHex(c.r,c.g,c.b); hi=mid; }
          else lo=mid;
        }
        // Also try toward black
        let lo2=0, hi2=l, bestHex2=fixed[j];
        for(let k=0;k<20;k++){
          const mid=(lo2+hi2)/2;
          const c = hslToRgb(h, clamp(s,5,95), mid);
          if(contrastRatio(rgb1,c) >= threshold){ bestHex2=rgbToHex(c.r,c.g,c.b); lo2=mid; }
          else hi2=mid;
        }
        // Pick the one closer to original lightness
        const dl1 = Math.abs(rgbToHsl(...Object.values(hexToRgb(bestHex))).l - l);
        const dl2 = Math.abs(rgbToHsl(...Object.values(hexToRgb(bestHex2))).l - l);
        fixed[j] = dl1 < dl2 ? bestHex : bestHex2;
      }
    }
  }
  return fixed;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CLIPBOARD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function copyText(text) {
  if(navigator.clipboard){ navigator.clipboard.writeText(text); return; }
  const el=document.createElement('textarea');
  el.value=text; document.body.appendChild(el); el.select();
  document.execCommand('copy'); document.body.removeChild(el);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOAST COMPONENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function ToastContainer({toasts}) {
  return (
    <div style={{
      position:'fixed', bottom:24, left:'50%', transform:'translateX(-50%)',
      zIndex:9999, display:'flex', flexDirection:'column', gap:8, pointerEvents:'none',
      alignItems:'center'
    }}>
      {toasts.map(t=>(
        <div key={t.id} className="toast" role="status" aria-live="polite" style={{
          background:'rgba(20,20,35,0.92)', backdropFilter:'blur(12px)',
          border:'1px solid rgba(255,255,255,0.15)', borderRadius:10,
          padding:'8px 18px', fontSize:14, color:'rgba(255,255,255,0.9)',
          whiteSpace:'nowrap',
          animation: t.fading ? 'toastOut 0.3s ease forwards' : 'toastIn 0.15s ease forwards'
        }}>
          {t.message}
        </div>
      ))}
    </div>
  );
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MAIN APP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function App() {
  // Explorer state
  const [r, setR] = useState(180);
  const [g, setG] = useState(97);
  const [b, setB] = useState(240);
  const [pulseKey, setPulseKey] = useState(0);

  // Palette state
  const [baseColor, setBaseColor] = useState('#b461f0');
  const [harmonyMode, setHarmonyMode] = useState('analogous');
  const [palette, setPalette] = useState([]);
  const [fixedPalette, setFixedPalette] = useState(null);
  const [swatchKey, setSwatchKey] = useState(0);
  const [canvasTheme, setCanvasTheme] = useState('dark'); // 'dark' | 'light'

  // Accessibility state
  const [toolkitOpen, setToolkitOpen] = useState(false);
  const [contrastFg, setContrastFg] = useState('#b461f0');
  const [contrastBg, setContrastBg] = useState('#0a0a0f');
  const [activeSimulations, setActiveSimulations] = useState(new Set());
  const [accessibleMode, setAccessibleMode] = useState(false);
  const [contrastThreshold, setContrastThreshold] = useState('aa-normal');
  const [accessibleBg, setAccessibleBg] = useState('#ffffff');

  // Toast state
  const [toasts, setToasts] = useState([]);

  const mixedHex = rgbToHex(r, g, b);
  const textColor = getTextColor(mixedHex);

  /* â”€â”€ Toast â”€â”€ */
  const addToast = useCallback((message) => {
    const id = Date.now() + Math.random();
    setToasts(prev => [...prev, {id, message, fading:false}]);
    setTimeout(()=>{
      setToasts(prev=>prev.map(t=>t.id===id ? {...t,fading:true} : t));
      setTimeout(()=>setToasts(prev=>prev.filter(t=>t.id!==id)), 320);
    }, 1680);
  }, []);

  const copy = useCallback((hex) => {
    copyText(hex);
    addToast(`Copied ${hex.toUpperCase()}`);
  }, [addToast]);

  /* â”€â”€ Palette generation â”€â”€ */
  useEffect(()=>{
    const p = generatePalette(baseColor, harmonyMode);
    setPalette(p);
    setFixedPalette(null);
    setSwatchKey(k=>k+1);
  }, [baseColor, harmonyMode]);

  /* â”€â”€ Accessible mode enforcement â”€â”€ */
  useEffect(()=>{
    if(accessibleMode && palette.length>0){
      const thresh = THRESHOLD_MAP[contrastThreshold];
      setFixedPalette(autoFix(palette, thresh));
    } else {
      setFixedPalette(null);
    }
  }, [palette, accessibleMode, contrastThreshold, accessibleBg]);

  const displayPalette = fixedPalette || palette;

  /* â”€â”€ Contrast matrix â”€â”€ */
  const matrix = useMemo(()=>{
    return displayPalette.map((c1,i)=>
      displayPalette.map((c2,j)=>
        i===j ? null : contrastRatio(hexToRgb(c1), hexToRgb(c2))
      )
    );
  }, [displayPalette]);

  const threshold = THRESHOLD_MAP[contrastThreshold];
  const failingPairs = useMemo(()=>{
    const pairs = [];
    for(let i=0;i<displayPalette.length;i++)
      for(let j=i+1;j<displayPalette.length;j++)
        if(matrix[i] && matrix[i][j] < threshold) pairs.push([i,j]);
    return pairs;
  }, [matrix, threshold, displayPalette]);

  /* â”€â”€ WCAG contrast checker â”€â”€ */
  const fgRgb = hexToRgb(contrastFg);
  const bgRgb = hexToRgb(contrastBg);
  const ratio = contrastRatio(fgRgb, bgRgb);
  const wcag = {
    'AA Normal':  ratio >= 4.5,
    'AA Large':   ratio >= 3.0,
    'AAA Normal': ratio >= 7.1,
    'AAA Large':  ratio >= 4.5
  };

  /* â”€â”€ Handlers â”€â”€ */
  const handleCenterClick = () => {
    setBaseColor(mixedHex);
    setContrastFg(mixedHex);
    setPulseKey(k=>k+1);
    addToast('Base color updated!');
  };
  const handleCenterDblClick = (e) => {
    e.preventDefault();
    copy(mixedHex);
  };
  const inspireMe = () => {
    let hue, sat, light;
    do {
      hue   = Math.random()*360;
      sat   = 55 + Math.random()*30;   // 55â€“85
      light = 45 + Math.random()*20;   // 45â€“65
    } while(sat < 10 || (sat > 95 && (light < 20 || light > 80)));
    const rgb = hslToRgb(hue, sat, light);
    setR(rgb.r); setG(rgb.g); setB(rgb.b);
    const hex = rgbToHex(rgb.r,rgb.g,rgb.b);
    setBaseColor(hex);
    setContrastFg(hex);
    const modes = ['analogous','triadic','split-complementary','tetradic','aesthetic'];
    setHarmonyMode(modes[Math.floor(Math.random()*modes.length)]);
    addToast('Feeling inspired!');
  };
  const toggleSim = (type) => {
    setActiveSimulations(prev=>{
      const next = new Set(prev);
      next.has(type) ? next.delete(type) : next.add(type);
      return next;
    });
  };
  const handleAutoFix = () => {
    const fixed = autoFix(displayPalette, threshold);
    setFixedPalette(fixed);
    addToast('Palette auto-fixed!');
  };

  /* â”€â”€ Slider helpers â”€â”€ */
  const numInputStyle = {
    width:52, background:'#1a1a2a', border:'1px solid rgba(255,255,255,0.12)',
    borderRadius:6, color:'rgba(255,255,255,0.9)', padding:'4px 6px',
    fontSize:13, fontFamily:"'JetBrains Mono', monospace", textAlign:'center'
  };

  /* â”€â”€ Render â”€â”€ */
  return (
    <div style={{minHeight:'100vh', background:'#0a0a0f'}}>

      {/* â•â•â• HEADER â•â•â• */}
      <header style={{
        textAlign:'center', padding:'14px 0 10px',
        borderBottom:'1px solid rgba(255,255,255,0.06)',
        background:'#0a0a0f'
      }}>
        <h1 style={{fontSize:22, fontWeight:600, letterSpacing:1.5, margin:0}}>
          RGB Color Studio
        </h1>
        <p style={{fontSize:12, color:'rgba(255,255,255,0.4)', marginTop:4}}>
          Animated Explorer &nbsp;Â·&nbsp; Palette Generator &nbsp;Â·&nbsp; Accessibility Toolkit
        </p>
      </header>

      {/* â•â•â• EXPLORER SECTION â•â•â• */}
      <section className="explorer-section" style={{
        height:'55vh', minHeight:380, display:'flex', flexDirection:'column',
        borderBottom:'1px solid rgba(255,255,255,0.06)', position:'relative',
        overflow:'hidden', background:'#0a0a0f'
      }}>
        {/* Beam canvas */}
        <div className="beam-area" style={{
          flex:1, position:'relative', display:'flex',
          justifyContent:'center', alignItems:'flex-end', paddingBottom:24,
          minHeight:220
        }}>
          {/* â”€â”€ RED BEAM (upper-left) â”€â”€ */}
          <div
            className="beam"
            title={`Red: ${r}`}
            style={{
              position:'absolute', top:0, left:'8%',
              width:220, height:'78%',
              background:`linear-gradient(to bottom, rgba(255,30,30,${(r/255*0.9).toFixed(3)}), rgba(255,0,0,0.03))`,
              clipPath:'polygon(30% 0%, 70% 0%, 100% 100%, 0% 100%)',
              opacity: r/255,
              mixBlendMode:'screen',
              filter:'blur(10px)',
              transform:'rotate(-14deg)',
              transformOrigin:'bottom center',
              transition:'opacity 0.25s ease'
            }}
          />
          {/* â”€â”€ GREEN BEAM (upper-center) â”€â”€ */}
          <div
            className="beam"
            title={`Green: ${g}`}
            style={{
              position:'absolute', top:0, left:'50%', marginLeft:-100,
              width:200, height:'80%',
              background:`linear-gradient(to bottom, rgba(30,255,30,${(g/255*0.9).toFixed(3)}), rgba(0,255,0,0.03))`,
              clipPath:'polygon(25% 0%, 75% 0%, 100% 100%, 0% 100%)',
              opacity: g/255,
              mixBlendMode:'screen',
              filter:'blur(10px)',
              transition:'opacity 0.25s ease'
            }}
          />
          {/* â”€â”€ BLUE BEAM (upper-right) â”€â”€ */}
          <div
            className="beam"
            title={`Blue: ${b}`}
            style={{
              position:'absolute', top:0, right:'8%',
              width:220, height:'78%',
              background:`linear-gradient(to bottom, rgba(30,80,255,${(b/255*0.9).toFixed(3)}), rgba(0,0,255,0.03))`,
              clipPath:'polygon(30% 0%, 70% 0%, 100% 100%, 0% 100%)',
              opacity: b/255,
              mixBlendMode:'screen',
              filter:'blur(10px)',
              transform:'rotate(14deg)',
              transformOrigin:'bottom center',
              transition:'opacity 0.25s ease'
            }}
          />

          {/* â”€â”€ CENTER CIRCLE â”€â”€ */}
          <div
            key={pulseKey}
            className="center-circle"
            onClick={handleCenterClick}
            onDoubleClick={handleCenterDblClick}
            title="Click: set base color | Double-click: copy hex"
            style={{
              width:160, height:160, borderRadius:'50%',
              background: mixedHex,
              display:'flex', alignItems:'center', justifyContent:'center',
              cursor:'pointer',
              animation:'pulse 2s ease-in-out infinite, glow 2s ease-in-out infinite',
              '--glow-color': mixedHex + 'aa',
              transition:'background 0.25s ease',
              position:'relative', zIndex:10,
              userSelect:'none', flexShrink:0
            }}
          >
            <span style={{
              fontFamily:"'JetBrains Mono', monospace",
              fontSize:14, fontWeight:400,
              color: textColor, letterSpacing:1,
              pointerEvents:'none'
            }}>
              {mixedHex.toUpperCase()}
            </span>
          </div>
        </div>

        {/* â”€â”€ RGB SLIDERS â”€â”€ */}
        <div className="slider-row" style={{padding:'6px 12% 16px', display:'flex', flexDirection:'column', gap:10}}>
          {[
            {label:'R', cls:'r-slider', val:r, set:setR, color:'#ff4444', grad:'linear-gradient(to right,#000,#ff0000)', ariaLabel:'Red channel'},
            {label:'G', cls:'g-slider', val:g, set:setG, color:'#44dd44', grad:'linear-gradient(to right,#000,#00ff00)', ariaLabel:'Green channel'},
            {label:'B', cls:'b-slider', val:b, set:setB, color:'#4488ff', grad:'linear-gradient(to right,#000,#0000ff)', ariaLabel:'Blue channel'},
          ].map(({label,cls,val,set,color,grad,ariaLabel})=>(
            <div key={label} style={{display:'flex', alignItems:'center', gap:12}}>
              <span style={{width:14, fontWeight:600, color, fontSize:14, flexShrink:0}}>{label}</span>
              <input
                type="range" className={cls}
                min={0} max={255} value={val}
                aria-label={ariaLabel} aria-valuenow={val}
                onChange={e=>set(Number(e.target.value))}
                style={{flex:1, background:grad}}
              />
              <input
                type="number" min={0} max={255} value={val}
                style={numInputStyle}
                onChange={e=>set(clamp(Math.round(Number(e.target.value||0)),0,255))}
                onKeyDown={e=>{if(e.key==='Enter')e.target.blur();}}
              />
            </div>
          ))}
        </div>
      </section>

      {/* â•â•â• PALETTE GENERATOR SECTION â•â•â• */}
      {(()=>{
        const isDark = canvasTheme === 'dark';
        const canvasBg    = isDark ? '#12121a' : '#f4f4ef';
        const labelColor  = isDark ? 'rgba(255,255,255,0.4)'  : 'rgba(0,0,0,0.4)';
        const hexColor    = isDark ? 'rgba(255,255,255,0.9)'  : 'rgba(0,0,0,0.85)';
        const pillInactive= isDark ? 'rgba(255,255,255,0.07)' : 'rgba(0,0,0,0.07)';
        const pillBorder  = isDark ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.12)';
        const pillText    = isDark ? 'rgba(255,255,255,0.75)' : 'rgba(0,0,0,0.65)';
        const hintColor   = isDark ? 'rgba(255,255,255,0.25)' : 'rgba(0,0,0,0.3)';
        const swatchShadow= isDark
          ? 'inset 0 0 0 1px rgba(255,255,255,0.09), 0 4px 14px rgba(0,0,0,0.5)'
          : 'inset 0 0 0 1px rgba(0,0,0,0.1), 0 4px 14px rgba(0,0,0,0.15)';
        const swatchShadowHover = (hex) => isDark
          ? `inset 0 0 0 1px rgba(255,255,255,0.2), 0 4px 24px ${hex}99`
          : `inset 0 0 0 1px rgba(0,0,0,0.15), 0 4px 24px ${hex}88`;
        return (
        <section className="palette-section" style={{
          minHeight:'38vh', padding:'20px 6%',
          borderBottom:'1px solid rgba(255,255,255,0.06)',
          background: canvasBg,
          transition:'background 0.4s ease'
        }}>
          {/* Top row: base color indicator + canvas theme toggle */}
          <div style={{display:'flex', alignItems:'center', justifyContent:'space-between', marginBottom:18, flexWrap:'wrap', gap:10}}>
            <div style={{display:'flex', alignItems:'center', gap:10}}>
              <div style={{
                width:40, height:40, borderRadius:'50%',
                background:baseColor,
                border:`2px solid ${isDark ? 'rgba(255,255,255,0.15)' : 'rgba(0,0,0,0.12)'}`,
                flexShrink:0, boxShadow:`0 0 10px ${baseColor}66`
              }} />
              <div>
                <div style={{fontSize:10, color:labelColor, textTransform:'uppercase', letterSpacing:1}}>Base Color</div>
                <div style={{fontFamily:"'JetBrains Mono', monospace", fontSize:14, color:hexColor}}>{baseColor.toUpperCase()}</div>
              </div>
            </div>

            {/* Dark / Light canvas toggle */}
            <button
              className="pill"
              onClick={()=>setCanvasTheme(t=> t==='dark' ? 'light' : 'dark')}
              title="Toggle canvas background"
              style={{
                display:'flex', alignItems:'center', gap:7,
                padding:'6px 14px', borderRadius:20, fontSize:13, fontWeight:600,
                background: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.08)',
                color: isDark ? 'rgba(255,255,255,0.8)' : 'rgba(0,0,0,0.7)',
                border: `1px solid ${isDark ? 'rgba(255,255,255,0.12)' : 'rgba(0,0,0,0.15)'}`,
                transition:'all 0.3s ease'
              }}
            >
              <span style={{fontSize:15, lineHeight:1}}>{isDark ? 'â˜€ï¸' : 'ğŸŒ™'}</span>
              <span>{isDark ? 'Light canvas' : 'Dark canvas'}</span>
            </button>
          </div>

          {/* Harmony pills + Inspire Me */}
          <div style={{display:'flex', flexWrap:'wrap', alignItems:'center', gap:8, marginBottom:22}}>
            {[
              {id:'analogous',           label:'Analogous'},
              {id:'triadic',             label:'Triadic'},
              {id:'split-complementary', label:'Split-Comp'},
              {id:'tetradic',            label:'Tetradic'},
              {id:'aesthetic',           label:'Aesthetic'},
            ].map(mode=>{
              const active = harmonyMode===mode.id;
              return (
                <button
                  key={mode.id}
                  className="pill"
                  onClick={()=>setHarmonyMode(mode.id)}
                  style={{
                    padding:'6px 15px', borderRadius:20, fontSize:13,
                    fontWeight: active ? 600 : 400,
                    background: active ? baseColor : pillInactive,
                    color: active ? getTextColor(baseColor) : pillText,
                    boxShadow: active ? `0 0 12px ${baseColor}77` : 'none',
                    border: active ? 'none' : `1px solid ${pillBorder}`
                  }}
                >
                  {mode.label}
                </button>
              );
            })}
            <button
              className="pill inspire-btn"
              onClick={inspireMe}
              style={{
                marginLeft:'auto', padding:'7px 18px', borderRadius:20,
                fontSize:13, fontWeight:600,
                background:'linear-gradient(135deg,#7c3aed,#db2777)',
                color:'#fff', display:'flex', alignItems:'center', gap:6,
                boxShadow:'0 2px 12px rgba(124,58,237,0.4)'
              }}
            >
              Inspire Me <span className="dice">ğŸ²</span>
            </button>
          </div>

          {/* Palette swatches */}
          <div style={{display:'flex', gap:14, justifyContent:'center', flexWrap:'wrap'}}>
            {displayPalette.map((hex, i)=>(
              <div key={swatchKey + '-' + i} style={{display:'flex', flexDirection:'column', alignItems:'center', gap:6}}>
                <div
                  className="swatch swatch-rect"
                  aria-label={hex}
                  onClick={(e)=>{
                    if(e.shiftKey){ setContrastBg(hex); addToast('Background set'); }
                    else { copy(hex); setContrastFg(hex); }
                  }}
                  style={{
                    width:80, height:100, borderRadius:12,
                    background:hex,
                    boxShadow: swatchShadow,
                    animation:`fadeSlideUp 0.3s ease ${i*0.15}s both`,
                    transition:'box-shadow 0.2s ease'
                  }}
                  onMouseEnter={e=>{
                    e.currentTarget.style.boxShadow = swatchShadowHover(hex);
                  }}
                  onMouseLeave={e=>{
                    e.currentTarget.style.boxShadow = swatchShadow;
                  }}
                />
                <span style={{fontFamily:"'JetBrains Mono', monospace", fontSize:11, color: isDark ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'}}>
                  {hex.toUpperCase()}
                </span>
              </div>
            ))}
          </div>
          <p style={{fontSize:11, color: hintColor, textAlign:'center', marginTop:14}}>
            Click swatch to copy Â· Shift-click to set as contrast background Â· Click center circle to set base color
          </p>
        </section>
        );
      })()}

      {/* â•â•â• ACCESSIBILITY TOOLKIT â•â•â• */}
      <section style={{background:'#0d0d16'}}>
        {/* Accordion header */}
        <button
          onClick={()=>setToolkitOpen(o=>!o)}
          style={{
            width:'100%', background:'none', border:'none',
            borderBottom: toolkitOpen ? '1px solid rgba(255,255,255,0.06)' : 'none',
            color:'rgba(255,255,255,0.9)', padding:'15px 6%',
            display:'flex', alignItems:'center', justifyContent:'space-between',
            cursor:'pointer', fontFamily:'Inter, sans-serif', fontSize:15, fontWeight:600
          }}
        >
          <span>{toolkitOpen ? 'â–¾' : 'â–¸'} Accessibility Toolkit</span>
          <span style={{fontSize:12, fontWeight:400, color:'rgba(255,255,255,0.4)'}}>
            {toolkitOpen ? 'collapse' : 'expand'}
          </span>
        </button>

        <div className="toolkit-body" style={{
          maxHeight: toolkitOpen ? '9999px' : '0',
          opacity: toolkitOpen ? 1 : 0
        }}>
          <div style={{padding:'28px 6%', display:'flex', flexDirection:'column', gap:36}}>

            {/* â”€â”€ CONTRAST CHECKER â”€â”€ */}
            <div>
              <h3 style={{margin:'0 0 18px', fontSize:12, fontWeight:600, textTransform:'uppercase', letterSpacing:1.2, color:'rgba(255,255,255,0.4)'}}>
                Contrast Checker
              </h3>
              <div style={{display:'flex', flexWrap:'wrap', gap:24, alignItems:'flex-start'}}>
                {/* Color wells */}
                <div style={{display:'flex', gap:16}}>
                  {[
                    {label:'Foreground', val:contrastFg, set:setContrastFg},
                    {label:'Background', val:contrastBg, set:setContrastBg}
                  ].map(({label,val,set})=>(
                    <div key={label} style={{display:'flex', flexDirection:'column', alignItems:'center', gap:6}}>
                      <div style={{position:'relative', width:64, height:64}}>
                        <div style={{
                          width:64, height:64, borderRadius:10,
                          background:val, border:'2px solid rgba(255,255,255,0.12)',
                          boxShadow:`0 0 8px ${val}55`
                        }} />
                        <input
                          type="color" value={val}
                          onChange={e=>set(e.target.value)}
                          style={{position:'absolute',inset:0,opacity:0,cursor:'pointer',width:'100%',height:'100%'}}
                        />
                      </div>
                      <span style={{fontSize:11, color:'rgba(255,255,255,0.4)'}}>{label}</span>
                      <input
                        type="text" value={val.toUpperCase()}
                        onChange={e=>{ if(/^#[0-9a-fA-F]{6}$/.test(e.target.value)) set(e.target.value); }}
                        style={{
                          width:80, background:'#1a1a2a', border:'1px solid rgba(255,255,255,0.1)',
                          borderRadius:6, color:'rgba(255,255,255,0.85)', padding:'3px 6px',
                          fontSize:11, fontFamily:"'JetBrains Mono',monospace", textAlign:'center'
                        }}
                      />
                    </div>
                  ))}
                </div>

                {/* Ratio + badges */}
                <div style={{flex:1, minWidth:200}}>
                  <div style={{fontSize:40, fontWeight:600, fontFamily:"'JetBrains Mono',monospace", marginBottom:12, lineHeight:1}}>
                    {ratio.toFixed(2)}<span style={{fontSize:20, color:'rgba(255,255,255,0.4)'}}>:1</span>
                  </div>
                  <div style={{display:'grid', gridTemplateColumns:'1fr 1fr', gap:8}}>
                    {Object.entries(wcag).map(([label,pass])=>(
                      <div
                        key={label}
                        aria-label={`${label}: ${pass?'Pass':'Fail'}`}
                        style={{
                          display:'flex', alignItems:'center', gap:7,
                          background: pass ? 'rgba(34,197,94,0.1)' : 'rgba(239,68,68,0.1)',
                          border:`1px solid ${pass ? 'rgba(34,197,94,0.3)' : 'rgba(239,68,68,0.3)'}`,
                          borderRadius:8, padding:'6px 10px', fontSize:12
                        }}
                      >
                        <span>{pass ? 'âœ…' : 'âŒ'}</span>
                        <span style={{fontWeight:600}}>{label}</span>
                      </div>
                    ))}
                  </div>
                </div>
              </div>

              {/* Live text preview */}
              <div style={{
                marginTop:18, borderRadius:10, padding:'14px 18px',
                background:contrastBg, border:'1px solid rgba(255,255,255,0.07)'
              }}>
                <div style={{fontSize:16, color:contrastFg, marginBottom:8, lineHeight:1.5}}>
                  Sample text at 16px â€” The quick brown fox jumps over the lazy dog.
                </div>
                <div style={{fontSize:24, color:contrastFg, fontWeight:600, lineHeight:1.4}}>
                  Large text at 24px â€” Sample heading
                </div>
              </div>
            </div>

            {/* â”€â”€ COLOR BLINDNESS SIMULATOR â”€â”€ */}
            <div>
              <h3 style={{margin:'0 0 14px', fontSize:12, fontWeight:600, textTransform:'uppercase', letterSpacing:1.2, color:'rgba(255,255,255,0.4)'}}>
                Color Blindness Simulator
              </h3>
              <p style={{fontSize:12, color:'rgba(255,255,255,0.35)', marginBottom:14}}>
                Toggle multiple types â€” each shows a simulated palette row below the original.
              </p>
              {/* Type toggles */}
              <div style={{display:'flex', flexWrap:'wrap', gap:8, marginBottom:22}}>
                {['protanopia','deuteranopia','tritanopia','achromatopsia'].map(type=>{
                  const active = activeSimulations.has(type);
                  return (
                    <button
                      key={type}
                      className="pill"
                      onClick={()=>toggleSim(type)}
                      style={{
                        padding:'6px 14px', borderRadius:20, fontSize:13,
                        fontWeight: active ? 600 : 400,
                        background: active ? 'rgba(124,58,237,0.35)' : 'rgba(255,255,255,0.06)',
                        color: 'rgba(255,255,255,0.85)',
                        border:`1px solid ${active ? 'rgba(124,58,237,0.6)' : 'rgba(255,255,255,0.08)'}`,
                        textTransform:'capitalize'
                      }}
                    >
                      {type}
                    </button>
                  );
                })}
              </div>

              {/* Original palette row */}
              <SwatchRow label="Original" palette={displayPalette} />

              {/* Simulated rows */}
              {[...activeSimulations].map(type=>(
                <SwatchRow
                  key={type}
                  label={type.charAt(0).toUpperCase()+type.slice(1)+' (simulated)'}
                  palette={displayPalette.map(h=>simulateCB(h,type))}
                />
              ))}
            </div>

            {/* â”€â”€ ACCESSIBLE PALETTE MODE â”€â”€ */}
            <div style={{paddingBottom:24}}>
              <div style={{display:'flex', alignItems:'center', justifyContent:'space-between', marginBottom:16}}>
                <h3 style={{margin:0, fontSize:12, fontWeight:600, textTransform:'uppercase', letterSpacing:1.2, color:'rgba(255,255,255,0.4)'}}>
                  Accessible Palette Mode
                </h3>
                <button
                  onClick={()=>setAccessibleMode(m=>!m)}
                  style={{
                    background: accessibleMode ? '#22c55e' : 'rgba(255,255,255,0.1)',
                    border:'none', borderRadius:20, padding:'6px 18px',
                    cursor:'pointer', fontFamily:'Inter,sans-serif',
                    color: accessibleMode ? '#000' : 'rgba(255,255,255,0.65)',
                    fontWeight:600, fontSize:13, transition:'all 0.2s'
                  }}
                >
                  {accessibleMode ? 'âœ“ ON' : 'OFF'}
                </button>
              </div>

              {accessibleMode && (
                <div>
                  {/* Controls */}
                  <div style={{display:'flex', flexWrap:'wrap', gap:16, marginBottom:20}}>
                    <div>
                      <label style={{fontSize:12, color:'rgba(255,255,255,0.4)', display:'block', marginBottom:6}}>Background Color</label>
                      <div style={{display:'flex', alignItems:'center', gap:8}}>
                        <input
                          type="color" value={accessibleBg}
                          onChange={e=>setAccessibleBg(e.target.value)}
                          style={{width:36, height:36, borderRadius:6, border:'1px solid rgba(255,255,255,0.1)', cursor:'pointer'}}
                        />
                        <input
                          type="text" value={accessibleBg}
                          onChange={e=>{ if(/^#[0-9a-fA-F]{6}$/.test(e.target.value)) setAccessibleBg(e.target.value); }}
                          style={{
                            width:90, background:'#1a1a2a', border:'1px solid rgba(255,255,255,0.1)',
                            borderRadius:6, color:'rgba(255,255,255,0.9)', padding:'6px 8px',
                            fontSize:12, fontFamily:"'JetBrains Mono',monospace"
                          }}
                        />
                      </div>
                    </div>
                    <div>
                      <label style={{fontSize:12, color:'rgba(255,255,255,0.4)', display:'block', marginBottom:6}}>Threshold</label>
                      <select
                        value={contrastThreshold}
                        onChange={e=>setContrastThreshold(e.target.value)}
                        style={{
                          background:'#1a1a2a', border:'1px solid rgba(255,255,255,0.1)',
                          borderRadius:6, color:'rgba(255,255,255,0.9)', padding:'7px 12px',
                          fontSize:12, cursor:'pointer'
                        }}
                      >
                        <option value="aa-normal">AA Normal (â‰¥4.5:1)</option>
                        <option value="aa-large">AA Large (â‰¥3:1)</option>
                        <option value="aaa-normal">AAA Normal (â‰¥7.1:1)</option>
                        <option value="aaa-large">AAA Large (â‰¥4.5:1)</option>
                      </select>
                    </div>
                  </div>

                  {/* Contrast Matrix */}
                  <div style={{marginBottom:18}}>
                    <div style={{fontSize:12, color:'rgba(255,255,255,0.4)', marginBottom:10}}>Contrast Matrix</div>
                    <div role="grid" style={{overflowX:'auto'}}>
                      <table style={{borderCollapse:'separate', borderSpacing:4, fontSize:11}}>
                        <thead>
                          <tr>
                            <th style={{width:28}} />
                            {displayPalette.map((_,j)=>(
                              <th key={j} role="columnheader" aria-label={`Color ${j+1}`}
                                style={{width:58, textAlign:'center', color:'rgba(255,255,255,0.4)', fontWeight:400, paddingBottom:4}}>
                                C{j+1}
                              </th>
                            ))}
                          </tr>
                        </thead>
                        <tbody>
                          {displayPalette.map((_,i)=>(
                            <tr key={i}>
                              <th role="rowheader" aria-label={`Color ${i+1}`}
                                style={{color:'rgba(255,255,255,0.4)', fontWeight:400, textAlign:'right', paddingRight:8, fontSize:11}}>
                                C{i+1}
                              </th>
                              {displayPalette.map((_,j)=>{
                                if(i===j) return (
                                  <td key={j} style={{width:58, height:30, background:'rgba(255,255,255,0.02)', borderRadius:4, textAlign:'center', color:'rgba(255,255,255,0.15)', fontSize:14}}>â€”</td>
                                );
                                const rv = matrix[i] ? matrix[i][j] : null;
                                if(rv===null) return <td key={j} />;
                                const pass = rv >= threshold;
                                return (
                                  <td key={j} title={`${rv.toFixed(2)}:1`} style={{
                                    width:58, height:30, borderRadius:4, textAlign:'center',
                                    background: pass ? 'rgba(34,197,94,0.12)' : 'rgba(239,68,68,0.12)',
                                    border:`1px solid ${pass ? 'rgba(34,197,94,0.28)' : 'rgba(239,68,68,0.28)'}`,
                                    color: pass ? '#4ade80' : '#f87171',
                                    fontSize:10, cursor:'default', verticalAlign:'middle'
                                  }}>
                                    {rv.toFixed(1)}<span style={{fontSize:8}}>{pass?'âœ“':'âœ—'}</span>
                                  </td>
                                );
                              })}
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>

                  {/* Auto-fix banner */}
                  {failingPairs.length > 0 ? (
                    <div style={{
                      display:'flex', alignItems:'center', flexWrap:'wrap', gap:12,
                      padding:'12px 16px',
                      background:'rgba(251,191,36,0.08)',
                      border:'1px solid rgba(251,191,36,0.25)', borderRadius:10, fontSize:13
                    }}>
                      <span>âš  {failingPairs.length} pair{failingPairs.length!==1?'s':''} fail {thresholdLabel(contrastThreshold)}.</span>
                      <button
                        onClick={handleAutoFix}
                        style={{
                          background:'rgba(251,191,36,0.18)', border:'1px solid rgba(251,191,36,0.4)',
                          borderRadius:8, color:'#fbbf24', padding:'6px 14px',
                          cursor:'pointer', fontFamily:'Inter,sans-serif', fontSize:12, fontWeight:600
                        }}
                      >
                        Auto-Fix Suggestions
                      </button>
                    </div>
                  ) : (
                    <div style={{
                      display:'flex', alignItems:'center', gap:8, padding:'10px 14px',
                      background:'rgba(34,197,94,0.08)', border:'1px solid rgba(34,197,94,0.25)',
                      borderRadius:10, fontSize:13
                    }}>
                      âœ… All pairs pass {thresholdLabel(contrastThreshold)} threshold!
                    </div>
                  )}
                </div>
              )}
            </div>
          </div>
        </div>
      </section>

      <ToastContainer toasts={toasts} />
    </div>
  );
}

/* â”€â”€ Mini swatch row for CB simulator â”€â”€ */
function SwatchRow({label, palette}) {
  return (
    <div style={{marginBottom:16}}>
      <div style={{fontSize:12, color:'rgba(255,255,255,0.4)', marginBottom:8, textTransform:'capitalize'}}>{label}</div>
      <div style={{display:'flex', gap:8, flexWrap:'wrap'}}>
        {palette.map((hex,i)=>(
          <div key={i} style={{display:'flex', flexDirection:'column', alignItems:'center', gap:4}}>
            <div style={{width:52, height:52, borderRadius:8, background:hex, border:'1px solid rgba(255,255,255,0.1)'}} />
            <span style={{fontSize:9, fontFamily:"'JetBrains Mono',monospace", color:'rgba(255,255,255,0.35)'}}>{hex.toUpperCase()}</span>
          </div>
        ))}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
